{% extends 'base.html' %}
{% load static %}
{% block title %}{% if form.revise.value == True %}Revise And Resubmit {% else %}Create New Article {% endif %}{% endblock %}
{% block description %}{% if form.revise.value == True %}Edit{% else %}Create{% endif %} your article, share to our audience and smile at your bank{% endblock %}
{% block content %}
<style>
    .img-preview{
        height: 200px;
        width: 260px;
        background: #fff;
        overflow: hidden;

    }
    .img-preview img{
        width: 100%;
        height: 100%;
        object-fit: cover;
    }
    .custom-file input[type='file']{
        display: none;
    }
    .custom-file label{
        cursor: pointer;
        color: #000;
        margin: auto;
        margin-top: 15px;
    }
</style>

<div class="container border-top p-3">
    <form  method="POST"  enctype="multipart/form-data">
        {% csrf_token %}

        <!--CKeditor Script-->
        <script type="text/javascript" src="/static/ckeditor/ckeditor-init.js" data-ckeditor-basepath="/static/ckeditor/ckeditor/" id="ckeditor-init-script"></script>
        <script type="text/javascript" src="/static/ckeditor/ckeditor/ckeditor.js"></script>
        {{form.non_field_errors }}
        {{form.field.errors }}
        <div class="form-group">
            <label for="id_title">Title:</label>
            {% if form.title.value %}
            <input class='form-control' type="text" name="title" minlenght="30" maxlength="120" value="{{form.title.value}}" required id="id_title">
            {% else %}
            <input class='form-control' type="text" name="title" minlenght="30" maxlength="120"  required id="id_title">
            {% endif %}
            {{ form.title.errors }}
        </div>

        <div class="form-group">
            <label for="id_body">Body:</label>
            <div class="django-ckeditor-widget" data-field-id="id_body">
                {% if form.body.value %}
                <textarea cols="40" id="id_body" name="body" rows="10" required data-processed="0" data-config="{&quot;skin&quot;: &quot;moono-lisa&quot;, &quot;toolbar_Basic&quot;: [[&quot;Source&quot;, &quot;-&quot;, &quot;Bold&quot;, &quot;Italic&quot;]], &quot;toolbar_Full&quot;: [[&quot;Styles&quot;, &quot;Format&quot;, &quot;Bold&quot;, &quot;Italic&quot;, &quot;Underline&quot;, &quot;Strike&quot;, &quot;SpellChecker&quot;, &quot;Undo&quot;, &quot;Redo&quot;], [&quot;Link&quot;, &quot;Unlink&quot;, &quot;Anchor&quot;], [&quot;Image&quot;, &quot;Flash&quot;, &quot;Table&quot;, &quot;HorizontalRule&quot;], [&quot;TextColor&quot;, &quot;BGColor&quot;], [&quot;Smiley&quot;, &quot;SpecialChar&quot;], [&quot;Source&quot;]], &quot;toolbar&quot;: &quot;Special&quot;, &quot;height&quot;: &quot;600px&quot;, &quot;width&quot;: &quot;100%&quot;, &quot;filebrowserWindowWidth&quot;: 940, &quot;filebrowserWindowHeight&quot;: 725, &quot;contentsCss&quot;: &quot;img {max-width: 100%;height: auto !important;}&quot;, &quot;toolbar_Special&quot;: [[&quot;Bold&quot;, &quot;Youtube&quot;, &quot;Image&quot;],[&quot;Wordcount&quot;, &quot;Notification&quot;], [&quot;Link&quot;], [&quot;Undo&quot;, &quot;Redo&quot;]], &quot;extraPlugins&quot;: &quot;youtube,image2,wordcount,notification&quot;, &quot;filebrowserUploadUrl&quot;: &quot;/ckeditor/upload/&quot;, &quot;filebrowserBrowseUrl&quot;: &quot;/ckeditor/browse/&quot;, &quot;language&quot;: &quot;en-us&quot;}" data-external-plugin-resources="[[&quot;youtube&quot;, &quot;/static/vendor/ckeditor_plugins/youtube/&quot;, &quot;plugin.js&quot;],[&quot;wordcount&quot;, &quot;/static/vendor/ckeditor_plugins/wordcount/&quot;, &quot;plugin.js&quot;], [&quot;notification&quot;, &quot;/static/vendor/ckeditor_plugins/notification/&quot;, &quot;plugin.js&quot;]]" data-id="id_body" data-type="ckeditortype">{{form.body.value}}</textarea>
                {% else %}
                <textarea cols="40" id="id_body" name="body" rows="10" required data-processed="0" data-config="{&quot;skin&quot;: &quot;moono-lisa&quot;, &quot;toolbar_Basic&quot;: [[&quot;Source&quot;, &quot;-&quot;, &quot;Bold&quot;, &quot;Italic&quot;]], &quot;toolbar_Full&quot;: [[&quot;Styles&quot;, &quot;Format&quot;, &quot;Bold&quot;, &quot;Italic&quot;, &quot;Underline&quot;, &quot;Strike&quot;, &quot;SpellChecker&quot;, &quot;Undo&quot;, &quot;Redo&quot;], [&quot;Link&quot;, &quot;Unlink&quot;, &quot;Anchor&quot;], [&quot;Image&quot;, &quot;Flash&quot;, &quot;Table&quot;, &quot;HorizontalRule&quot;], [&quot;TextColor&quot;, &quot;BGColor&quot;], [&quot;Smiley&quot;, &quot;SpecialChar&quot;], [&quot;Source&quot;]], &quot;toolbar&quot;: &quot;Special&quot;, &quot;height&quot;: &quot;600px&quot;, &quot;width&quot;: &quot;100%&quot;, &quot;filebrowserWindowWidth&quot;: 940, &quot;filebrowserWindowHeight&quot;: 725, &quot;contentsCss&quot;: &quot;img {max-width: 100%;height: auto !important;}&quot;, &quot;toolbar_Special&quot;: [[&quot;Bold&quot;, &quot;Youtube&quot;, &quot;Image&quot;],[&quot;Wordcount&quot;, &quot;Notification&quot;], [&quot;Link&quot;], [&quot;Undo&quot;, &quot;Redo&quot;]], &quot;extraPlugins&quot;: &quot;youtube,image2,wordcount,notification&quot;, &quot;filebrowserUploadUrl&quot;: &quot;/ckeditor/upload/&quot;, &quot;filebrowserBrowseUrl&quot;: &quot;/ckeditor/browse/&quot;, &quot;language&quot;: &quot;en-us&quot;}" data-external-plugin-resources="[[&quot;youtube&quot;, &quot;/static/vendor/ckeditor_plugins/youtube/&quot;, &quot;plugin.js&quot;],[&quot;wordcount&quot;, &quot;/static/vendor/ckeditor_plugins/wordcount/&quot;, &quot;plugin.js&quot;], [&quot;notification&quot;, &quot;/static/vendor/ckeditor_plugins/notification/&quot;, &quot;plugin.js&quot;]]" data-id="id_body" data-type="ckeditortype"></textarea>
                {% endif %}
                {{ form.body.errors }}
            </div>
        </div>
        <div class="form-group">
            <label for="id_category">Category:</label>
            <select class="form-control" name="category" id="id_category">
                {% for c in cat %}
                {% if form.category.value == c.id %}
                <option value="{{c.id}}" selected>{{c}}</option>
                {% else %}
                <option value="{{c.id}}">{{c}}</option>
                {% endif %}
                {% empty %}
                <option value="" >---------</option>
                {% endfor %}
            </select>
            {{ form.category.errors }}
        </div>

        <div class="form-group">
            <label for="id_tag">Tags:</label>
            <input type="text" name="tag" id="id_tag" data-role="tagsinput">
            {{ form.tag.errors }}
        </div>
        <div class="form-group">
        <label for="id_article_type">Revenue type:</label>
        <select class="form-control" name="article_type" id="id_article_type">
            <option value="">---------</option>
            <option value="ppa">PPA (revenue will be paid once irrespective of the click)</option>
            <option value="ppc">PPC (revenue will be paid per click accumulated)</option>
          
          </select>
        </div>
        <div class="form-group">
            <div class="img-preview">
                {% if form.image_upload.value %}
                <img src="/media/{{form.image_upload.value}}" alt="article_image" id="img_preview" class="rounded border border-dark">
                {% else %}
                <img src="{% static 'images/default.png' %}" alt="article_image" id="img_preview" class="rounded border border-info">
                {% endif %}

            </div>
            <div class="custom-file">
                <label class ="btn btn-primary text-white" for="id_image_upload">{% if form.image_upload.value %}Change Thumbnail{% else %}Add Thumbnail{% endif %}</label>
                <input type="file" name="image_upload" accept="image/*" onchange ='PreviewImage(event)'  id="id_image_upload">
                {{form.image_upload.errors}}
            </div>
        </div>
        <div class="form-group ">
            {% if request.user.creatorprofile.is_approved and not request.user.creatorprofile.banned  %}
            <button type="submit" class="btn btn-primary mt-2">Publish</button>
            {% else %}
            {% if request.user.creatorprofile.banned %}
            <span class="text-danger">Your account has been banned. Contact administrator if you are seeing this by mistake</span>
            {% else %}
            <span class="text-warning">Your account is awaiting approval, you will be able to publish as soon as it is approved</span>
            {% endif %}
            {% endif %}
        </div>
      
    </form>
</div>

<script type="text/javascript">
    function PreviewImage(event){
        var output = document.getElementById('img_preview');
        output.src = URL.createObjectURL(event.target.files[0]);
    };
</script>
{% endblock %}